<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>دفتر الملاحظات الاحترافي</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap');
        * { font-family: 'Tajawal', sans-serif; }
        .note-card { transition: all 0.3s ease; animation: slideIn 0.5s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
        .note-card:hover { transform: translateY(-5px); box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15); }
        .priority-high { border-right: 4px solid #ef4444; }
        .priority-medium { border-right: 4px solid #f59e0b; }
        .priority-low { border-right: 4px solid #10b981; }
        .dark-mode { background-color: #1a1a1a; color: #ffffff; }
        .dark-mode .bg-white { background-color: #2d2d2d !important; }
        .dark-mode .text-gray-600 { color: #d1d5db !important; }
        .dark-mode .text-gray-700 { color: #e5e7eb !important; }
        .dark-mode .bg-gray-50 { background-color: #374151 !important; }
        .dark-mode .border-gray-200 { border-color: #4b5563 !important; }
        .dark-mode .text-gray-500 { color: #9ca3af !important; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .modal-backdrop { backdrop-filter: blur(5px); }
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #555; }
        .dark-mode .custom-scrollbar::-webkit-scrollbar-track { background: #374151; }
        .dark-mode .custom-scrollbar::-webkit-scrollbar-thumb { background: #6b7280; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen transition-colors duration-300">
    <!-- Header -->
    <header class="bg-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4 space-x-reverse">
                    <i class="fas fa-sticky-note text-3xl text-blue-600"></i>
                    <h1 class="text-2xl font-bold text-gray-800">دفتر الملاحظات الاحترافي</h1>
                </div>
                <div class="flex items-center space-x-4 space-x-reverse">
                    <button id="searchToggle" class="p-2 rounded-lg hover:bg-gray-100 transition-colors">
                        <i class="fas fa-search text-gray-600"></i>
                    </button>
                    <button id="darkModeToggle" class="p-2 rounded-lg hover:bg-gray-100 transition-colors">
                        <i class="fas fa-moon text-gray-600"></i>
                    </button>
                    <button id="addNoteBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2 space-x-reverse">
                        <i class="fas fa-plus"></i>
                        <span>ملاحظة جديدة</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Search Bar -->
    <div id="searchBar" class="hidden bg-white shadow-md p-4 fade-in">
        <div class="container mx-auto">
            <div class="relative">
                <input type="text" id="searchInput" placeholder="ابحث في الملاحظات..." class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Filters -->
        <div class="mb-6 flex flex-wrap gap-4">
            <select id="categoryFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="">جميع الفئات</option>
                <option value="عمل">عمل</option>
                <option value="شخصي">شخصي</option>
                <option value="دراسة">دراسة</option>
                <option value="أفكار">أفكار</option>
            </select>
            <select id="priorityFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="">جميع الأولويات</option>
                <option value="high">عالية</option>
                <option value="medium">متوسطة</option>
                <option value="low">منخفضة</option>
            </select>
            <select id="sortBy" class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="date">حسب التاريخ</option>
                <option value="title">حسب العنوان</option>
                <option value="priority">حسب الأولوية</option>
            </select>
        </div>

        <!-- Notes Grid -->
        <div id="notesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>

        <!-- Empty State -->
        <div id="emptyState" class="text-center py-16 hidden">
            <i class="fas fa-sticky-note text-6xl text-gray-300 mb-4"></i>
            <p class="text-xl text-gray-500">لا توجد ملاحظات بعد</p>
            <p class="text-gray-400 mt-2">انقر على "ملاحظة جديدة" للبدء</p>
        </div>
    </main>

    <!-- Note Modal (Edit) -->
    <div id="noteModal" class="fixed inset-0 bg-black bg-opacity-50 modal-backdrop hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden">
            <div class="p-6 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h2 id="modalTitle" class="text-xl font-bold text-gray-800">ملاحظة جديدة</h2>
                    <button id="closeModal" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            <div class="p-6 overflow-y-auto max-h-[calc(90vh-200px)]">
                <form id="noteForm">
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">العنوان</label>
                        <input type="text" id="noteTitle" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">المحتوى</label>
                        <div class="editor-toolbar flex gap-2 mb-2 p-2 bg-gray-50 rounded-lg">
                            <button type="button" onclick="formatText('bold')" class="p-2 rounded hover:bg-gray-200"><i class="fas fa-bold"></i></button>
                            <button type="button" onclick="formatText('italic')" class="p-2 rounded hover:bg-gray-200"><i class="fas fa-italic"></i></button>
                            <button type="button" onclick="formatText('underline')" class="p-2 rounded hover:bg-gray-200"><i class="fas fa-underline"></i></button>
                            <button type="button" onclick="formatText('insertUnorderedList')" class="p-2 rounded hover:bg-gray-200"><i class="fas fa-list-ul"></i></button>
                            <button type="button" onclick="formatText('insertOrderedList')" class="p-2 rounded hover:bg-gray-200"><i class="fas fa-list-ol"></i></button>
                        </div>
                        <div id="noteContent" contenteditable="true" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-[150px] max-h-[300px] overflow-y-auto"></div>
                    </div>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">الفئة</label>
                            <select id="noteCategory" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="شخصي">شخصي</option>
                                <option value="عمل">عمل</option>
                                <option value="دراسة">دراسة</option>
                                <option value="أفكار">أفكار</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">الأولوية</label>
                            <select id="notePriority" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="low">منخفضة</option>
                                <option value="medium">متوسطة</option>
                                <option value="high">عالية</option>
                            </select>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">التاريخ المستهدف</label>
                        <input type="date" id="noteDueDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">الوسوم (افصل بينها بفاصلة)</label>
                        <input type="text" id="noteTags" placeholder="مثال: مهم, عاجل, اجتماع" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </form>
            </div>
            <div class="p-6 border-t border-gray-200 flex justify-end space-x-3 space-x-reverse">
                <button id="cancelBtn" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">إلغاء</button>
                <button id="saveNoteBtn" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">حفظ الملاحظة</button>
            </div>
        </div>
    </div>

    <!-- View Note Modal -->
    <div id="viewNoteModal" class="fixed inset-0 bg-black bg-opacity-50 modal-backdrop hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden">
            <div class="p-6 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h2 id="viewNoteTitle" class="text-2xl font-bold text-gray-800"></h2>
                    <div class="flex items-center space-x-3 space-x-reverse">
                        <button onclick="printNote()" class="p-2 text-gray-600 hover:text-gray-800" title="طباعة"><i class="fas fa-print"></i></button>
                        <button onclick="closeViewModal()" class="text-gray-500 hover:text-gray-700"><i class="fas fa-times text-xl"></i></button>
                    </div>
                </div>
            </div>
            <div class="p-6 overflow-y-auto max-h-[calc(90vh-140px)] custom-scrollbar">
                <div class="mb-6">
                    <div class="flex flex-wrap items-center gap-4 mb-4">
                        <div class="flex items-center space-x-2 space-x-reverse">
                            <i class="fas fa-folder text-gray-500"></i>
                            <span class="text-gray-600">الفئة:</span>
                            <span id="viewNoteCategory" class="font-medium"></span>
                        </div>
                        <div class="flex items-center space-x-2 space-x-reverse">
                            <i class="fas fa-flag text-gray-500"></i>
                            <span class="text-gray-600">الأولوية:</span>
                            <span id="viewNotePriority" class="font-medium"></span>
                        </div>
                        <div id="viewNoteDueDateContainer" class="hidden flex items-center space-x-2 space-x-reverse">
                            <i class="fas fa-calendar text-gray-500"></i>
                            <span class="text-gray-600">التاريخ المستهدف:</span>
                            <span id="viewNoteDueDate" class="font-medium"></span>
                        </div>
                    </div>
                    <div id="viewNoteTagsContainer" class="hidden mb-4">
                        <div class="flex items-center space-x-2 space-x-reverse mb-2">
                            <i class="fas fa-tags text-gray-500"></i>
                            <span class="text-gray-600">الوسوم:</span>
                        </div>
                        <div id="viewNoteTags" class="flex flex-wrap gap-2"></div>
                    </div>
                </div>
                <div class="prose max-w-none">
                    <div id="viewNoteContent" class="text-gray-700 leading-relaxed"></div>
                </div>
                <div class="mt-6 pt-6 border-t border-gray-200 text-sm text-gray-500">
                    <div class="flex justify-between">
                        <div><i class="fas fa-clock"></i> <span>تم الإنشاء: </span><span id="viewNoteCreated"></span></div>
                        <div><i class="fas fa-edit"></i> <span>آخر تعديل: </span><span id="viewNoteUpdated"></span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State
        let notes = JSON.parse(localStorage.getItem('professionalNotes')) || [];
        let editingNoteId = null;
        let viewingNoteId = null;
        let darkMode = localStorage.getItem('darkMode') === 'true';

        // Constants
        const categoryIcons = { عمل: 'fa-briefcase', شخصي: 'fa-user', دراسة: 'fa-graduation-cap', أفكار: 'fa-lightbulb' };
        const priorityColors = { high: 'text-red-600', medium: 'text-yellow-600', low: 'text-green-600' };
        const priorityText = { high: 'عالية', medium: 'متوسطة', low: 'منخفضة' };
        const priorityOrder = { high: 0, medium: 1, low: 2 };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            if (darkMode) {
                document.body.classList.add('dark-mode');
                document.getElementById('darkModeToggle').innerHTML = '<i class="fas fa-sun text-gray-600"></i>';
            }
            renderNotes();
            setupEventListeners();
        });

        // Event Listeners
        function setupEventListeners() {
            document.getElementById('addNoteBtn').addEventListener('click', () => openModal());
            document.getElementById('closeModal').addEventListener('click', closeModal);
            document.getElementById('cancelBtn').addEventListener('click', closeModal);
            document.getElementById('saveNoteBtn').addEventListener('click', saveNote);
            document.getElementById('searchToggle').addEventListener('click', toggleSearch);
            document.getElementById('darkModeToggle').addEventListener('click', toggleDarkMode);
            document.getElementById('searchInput').addEventListener('input', filterNotes);
            document.getElementById('categoryFilter').addEventListener('change', filterNotes);
            document.getElementById('priorityFilter').addEventListener('change', filterNotes);
            document.getElementById('sortBy').addEventListener('change', filterNotes);
            document.getElementById('noteModal').addEventListener('click', (e) => e.target.id === 'noteModal' && closeModal());
            document.getElementById('viewNoteModal').addEventListener('click', (e) => e.target.id === 'viewNoteModal' && closeViewModal());
        }

        // Modal Functions
        function openModal(noteId = null) {
            editingNoteId = noteId;
            const modal = document.getElementById('noteModal');
            const modalTitle = document.getElementById('modalTitle');
            
            if (noteId) {
                const note = notes.find(n => n.id === noteId);
                modalTitle.textContent = 'تعديل الملاحظة';
                document.getElementById('noteTitle').value = note.title;
                document.getElementById('noteContent').innerHTML = note.content;
                document.getElementById('noteCategory').value = note.category;
                document.getElementById('notePriority').value = note.priority;
                document.getElementById('noteDueDate').value = note.dueDate || '';
                document.getElementById('noteTags').value = note.tags.join(', ');
            } else {
                modalTitle.textContent = 'ملاحظة جديدة';
                document.getElementById('noteForm').reset();
                document.getElementById('noteContent').innerHTML = '';
            }
            modal.classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('noteModal').classList.add('hidden');
            editingNoteId = null;
        }

        function viewNote(noteId) {
            viewingNoteId = noteId;
            const note = notes.find(n => n.id === noteId);
            if (!note) return showNotification('الملاحظة غير موجودة', 'error');
            
            document.getElementById('viewNoteTitle').textContent = note.title;
            document.getElementById('viewNoteCategory').textContent = note.category;
            
            const priorityElement = document.getElementById('viewNotePriority');
            priorityElement.textContent = priorityText[note.priority];
            priorityElement.className = `font-medium ${priorityColors[note.priority]}`;
            
            const dueDateContainer = document.getElementById('viewNoteDueDateContainer');
            if (note.dueDate) {
                dueDateContainer.classList.remove('hidden');
                const dueDate = new Date(note.dueDate);
                const dueDateElement = document.getElementById('viewNoteDueDate');
                dueDateElement.textContent = dueDate.toLocaleDateString('ar-SA');
                dueDateElement.className = `font-medium ${dueDate < new Date() ? 'text-red-600' : 'text-gray-700'}`;
            } else {
                dueDateContainer.classList.add('hidden');
            }
            
            const tagsContainer = document.getElementById('viewNoteTagsContainer');
            if (note.tags.length > 0) {
                tagsContainer.classList.remove('hidden');
                document.getElementById('viewNoteTags').innerHTML = note.tags.map(tag => 
                    `<span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm">${tag}</span>`
                ).join('');
            } else {
                tagsContainer.classList.add('hidden');
            }
            
            document.getElementById('viewNoteContent').innerHTML = note.content;
            document.getElementById('viewNoteCreated').textContent = new Date(note.createdAt).toLocaleString('ar-SA');
            document.getElementById('viewNoteUpdated').textContent = new Date(note.updatedAt).toLocaleString('ar-SA');
            document.getElementById('viewNoteModal').classList.remove('hidden');
        }

        function closeViewModal() {
            document.getElementById('viewNoteModal').classList.add('hidden');
            viewingNoteId = null;
        }

        // Note Operations
        function saveNote() {
            const title = document.getElementById('noteTitle').value.trim();
            const content = document.getElementById('noteContent').innerHTML.trim();
            if (!title || !content) return showNotification('الرجاء ملء العنوان والمحتوى', 'error');
            
            const note = {
                id: editingNoteId || Date.now(),
                title,
                content,
                category: document.getElementById('noteCategory').value,
                priority: document.getElementById('notePriority').value,
                dueDate: document.getElementById('noteDueDate').value,
                tags: document.getElementById('noteTags').value.split(',').map(tag => tag.trim()).filter(tag => tag),
                createdAt: editingNoteId ? notes.find(n => n.id === editingNoteId).createdAt : new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            if (editingNoteId) {
                const index = notes.findIndex(n => n.id === editingNoteId);
                notes[index] = note;
                showNotification('تم تحديث الملاحظة بنجاح', 'success');
            } else {
                notes.unshift(note);
                showNotification('تم إضافة الملاحظة بنجاح', 'success');
            }
            
            localStorage.setItem('professionalNotes', JSON.stringify(notes));
            renderNotes();
            closeModal();
        }

        function deleteNote(noteId) {
            if (confirm('هل أنت متأكد من حذف هذه الملاحظة؟')) {
                notes = notes.filter(n => n.id !== noteId);
                localStorage.setItem('professionalNotes', JSON.stringify(notes));
                renderNotes();
                showNotification('تم حذف الملاحظة', 'success');
            }
        }

        // Render Functions
        function renderNotes(notesToRender = notes) {
            const grid = document.getElementById('notesGrid');
            const emptyState = document.getElementById('emptyState');
            
            if (notesToRender.length === 0) {
                grid.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }
            
            emptyState.classList.add('hidden');
            grid.innerHTML = notesToRender.map(note => {
                const dueDate = note.dueDate ? new Date(note.dueDate).toLocaleDateString('ar-SA') : '';
                const isOverdue = note.dueDate && new Date(note.dueDate) < new Date();
                
                return `
                    <div class="note-card bg-white rounded-lg shadow-md p-4 priority-${note.priority}">
                        <div class="flex justify-between items-start mb-3">
                            <h3 class="text-lg font-semibold text-gray-800 flex-1">${note.title}</h3>
                            <div class="flex space-x-1 space-x-reverse">
                                <button onclick="viewNote(${note.id})" class="text-green-600 hover:text-green-800 transition-colors p-1" title="عرض">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button onclick="openModal(${note.id})" class="text-blue-600 hover:text-blue-800 transition-colors p-1" title="تعديل">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="deleteNote(${note.id})" class="text-red-600 hover:text-red-800 transition-colors p-1" title="حذف">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <div class="text-gray-600 mb-3 text-sm overflow-hidden" style="max-height: 100px;">${note.content}</div>
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2 space-x-reverse">
                                <i class="fas ${categoryIcons[note.category]} text-gray-500"></i>
                                <span class="text-sm text-gray-600">${note.category}</span>
                            </div>
                            <span class="text-sm ${priorityColors[note.priority]} font-medium">${priorityText[note.priority]}</span>
                        </div>
                        ${dueDate ? `
                            <div class="flex items-center space-x-2 space-x-reverse mb-2">
                                <i class="fas fa-calendar text-gray-500"></i>
                                <span class="text-sm ${isOverdue ? 'text-red-600 font-medium' : 'text-gray-600'}">${dueDate}</span>
                            </div>
                        ` : ''}
                        ${note.tags.length > 0 ? `
                            <div class="flex flex-wrap gap-1 mt-3">
                                ${note.tags.slice(0, 3).map(tag => `<span class="bg-blue-100 text-blue-700 text-xs px-2 py-1 rounded-full">${tag}</span>`).join('')}
                                ${note.tags.length > 3 ? `<span class="text-xs text-gray-500">+${note.tags.length - 3}</span>` : ''}
                            </div>
                        ` : ''}
                        <div class="mt-3 pt-3 border-t border-gray-200 text-xs text-gray-500">
                            <i class="fas fa-clock"></i> ${new Date(note.createdAt).toLocaleString('ar-SA')}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Filter and Sort
        function filterNotes() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const priorityFilter = document.getElementById('priorityFilter').value;
            const sortBy = document.getElementById('sortBy').value;
            
            let filteredNotes = notes.filter(note => {
                const matchesSearch = !searchTerm || 
                    note.title.toLowerCase().includes(searchTerm) ||
                    note.content.toLowerCase().includes(searchTerm) ||
                    note.tags.some(tag => tag.toLowerCase().includes(searchTerm));
                const matchesCategory = !categoryFilter || note.category === categoryFilter;
                const matchesPriority = !priorityFilter || note.priority === priorityFilter;
                return matchesSearch && matchesCategory && matchesPriority;
            });
            
            filteredNotes.sort((a, b) => {
                switch (sortBy) {
                    case 'title': return a.title.localeCompare(b.title, 'ar');
                    case 'priority': return priorityOrder[a.priority] - priorityOrder[b.priority];
                    default: return new Date(b.createdAt) - new Date(a.createdAt);
                }
            });
            
            renderNotes(filteredNotes);
        }

        // Utility Functions
        function toggleSearch() {
            const searchBar = document.getElementById('searchBar');
            searchBar.classList.toggle('hidden');
            if (!searchBar.classList.contains('hidden')) {
                document.getElementById('searchInput').focus();
            }
        }

        function toggleDarkMode() {
            darkMode = !darkMode;
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', darkMode);
            document.getElementById('darkModeToggle').innerHTML = `<i class="fas ${darkMode ? 'fa-sun' : 'fa-moon'} text-gray-600"></i>`;
        }

        function formatText(command) {
            document.execCommand(command, false, null);
            document.getElementById('noteContent').focus();
        }

        function printNote() {
            const note = notes.find(n => n.id === viewingNoteId);
            if (!note) return;
            
            const printContent = `
                <html dir="rtl">
                <head>
                    <title>${note.title}</title>
                    <style>
                        body { font-family: 'Tajawal', sans-serif; padding: 20px; }
                        .header { border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
                        .meta { margin-bottom: 20px; }
                        .meta-item { margin-bottom: 5px; }
                        .content { line-height: 1.6; }
                        .tags { margin-top: 20px; }
                        .tag { background: #e0e7ff; color: #3730a3; padding: 2px 8px; border-radius: 12px; margin: 2px; display: inline-block; font-size: 12px; }
                    </style>
                </head>
                <body>
                    <div class="header"><h1>${note.title}</h1></div>
                    <div class="meta">
                        <div class="meta-item"><strong>الفئة:</strong> ${note.category}</div>
                        <div class="meta-item"><strong>الأولوية:</strong> ${priorityText[note.priority]}</div>
                        ${note.dueDate ? `<div class="meta-item"><strong>التاريخ المستهدف:</strong> ${new Date(note.dueDate).toLocaleDateString('ar-SA')}</div>` : ''}
                        <div class="meta-item"><strong>تم الإنشاء:</strong> ${new Date(note.createdAt).toLocaleString('ar-SA')}</div>
                    </div>
                    <div class="content">${note.content}</div>
                    ${note.tags.length > 0 ? `
                        <div class="tags">
                            <strong>الوسوم:</strong><br>
                            ${note.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                    ` : ''}
                </body>
                </html>
            `;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.print();
        }

        function showNotification(message, type = 'info') {
            const colors = { success: 'bg-green-500', error: 'bg-red-500', info: 'bg-blue-500' };
            const notification = document.createElement('div');
            notification.className = `fixed top-20 left-1/2 transform -translate-x-1/2 ${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg z-50 fade-in`;
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }
    </script>
</body>
</html>
